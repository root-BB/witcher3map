var L={};L.latLng=function(){},window.markers={},$.i18n.init(i18noptions,function(){$.i18n.loadNamespace("v",function(){$.cachedScript("files/scripts/mapdata-hos_velen.js").done(function(a,e){$.i18n.loadNamespace("g",function(){$.cachedScript("files/scripts/mapdata-gaunter.js").done(function(a,e){$.i18n.loadNamespace("s",function(){$.cachedScript("files/scripts/mapdata-skellige.js").done(function(a,e){$.i18n.loadNamespace("w",function(){$.cachedScript("files/scripts/mapdata-white_orchard.js").done(function(a,e){$.i18n.loadNamespace("k",function(){$.cachedScript("files/scripts/mapdata-kaer_morhen.js").done(function(a,e){$.i18n.loadNamespace("t",function(){$.cachedScript("files/scripts/mapdata-toussaint.js").done(function(a,e){$.i18n.loadNamespace("f",function(){$.cachedScript("files/scripts/mapdata-fables.js").done(function(a,e){$.i18n.loadNamespace("i",function(){$.cachedScript("files/scripts/mapdata-isle_mists.js").done(function(a,e){processData("velen",mapdata_hos_velen),processData("gaunter",mapdata_gaunter),processData("skellige",mapdata_skellige),processData("white_orchard",mapdata_white_orchard),processData("kaer_morhen",mapdata_kaer_morhen),processData("toussaint",mapdata_toussaint),processData("fables",mapdata_fables),processData("isle_mists",mapdata_isle_mists);var t=$("#search");t.keyup(function(){doSearch()}),t.val()&&doSearch(),$("#clear").click(function(){$("#search").val(""),$("#results").empty(),$("#clear").hide(),$("#nav").show()}),$(document).i18n()})})})})})})})})})})})})})})})})});var count=0,mapdata=[],processData=function(a,e){var t=a.charAt(0);$.each(e,function(e,c){$.each(c,function(e,c){if(c&&c.popup){var s,n=window.location.href.replace(window.location.hash,"").toString().slice(0,0)+t+"/index.html#3/"+c.coords[0][0]+"/"+c.coords[0][1]+"/m="+c.coords[0][0]+","+c.coords[0][1],o=c.popup.replace(/<\/?[^>]+(>|$)/g,""),r=c.popupTitle?c.popupTitle:"";s=""===r?c.label:r.indexOf(c.label)>-1?r:c.label+" ("+r+")",mapdata.push({id:count,map:$.t("maps."+a),label:s,popup:o,link:n}),count++}})})},doSearch=function(){var a=$("#search"),e=$("#results"),t=a.val();if(0===t.length){e.empty(),$("#clear").hide(),$("#nav").show();return}$("#clear").show(),$("#nav").hide();var c=new Fuse(mapdata,{caseSensitive:!1,includeScore:!1,shouldSort:!0,tokenize:!1,threshold:.2,location:0,distance:1e4,maxPatternLength:32,keys:["map","label","popup"]}).search(t);e.empty();var s="<li>"+c.length+" "+$.t("home.resultsFound")+"</li>";e.append($(s));var n=c.length;for(i=0;i<n;i++){var o='<li><div><a href="'+c[i].link+'">'+c[i].label+" - "+c[i].map+'</a></div><div class="searchDescription"><div class="truncated" onclick="toggleTruncate(event, this)">'+c[i].popup+"</div></div></li>";e.append($(o))}},toggleTruncate=function(a,e){a.preventDefault(),a.stopPropagation(),$(e).toggleClass("truncated")};$(function(){var a=$("#search-input-wrapper"),e=a.position();$(window).scroll(function(){$(window).scrollTop()>=e.top?$("#search").val()&&a.addClass("sticky"):a.removeClass("sticky")})});
